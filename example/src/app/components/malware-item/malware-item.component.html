<ion-card class="malwareCard">
  <ion-card-content>
    <ion-card class="malwareCard malwareCardInner" (click)="toggleExpanded()">
      <ion-row>
        <ion-img
          class="icon centered"
          [src]="'data:image/png;base64,' + susApp.packageInfo.appIcon"
        ></ion-img>
        <div class="titleTextContainer">
          <ion-text class="titleText">{{
            susApp.packageInfo.appName
          }}</ion-text>
        </div>
        <ion-icon
          [name]="expanded ? 'chevron-up' : 'chevron-down'"
          class="malwareIconTitle"
        ></ion-icon>
      </ion-row>
    </ion-card>
    @if (expanded) {
      <div>
        <div class="spacer"></div>
        <ion-text class="listItemTitle">Package name:</ion-text><br />
        <ion-text class="listItem">{{
          susApp.packageInfo.packageName
        }}</ion-text
        ><br />

        <ion-text class="listItemTitle">App name:</ion-text><br />
        <ion-text class="listItem">{{
          susApp.packageInfo.appName ?? 'Not specified'
        }}</ion-text
        ><br />

        <ion-text class="listItemTitle">App version:</ion-text><br />
        <ion-text class="listItem">{{
          susApp.packageInfo.version ?? 'Not specified'
        }}</ion-text
        ><br />

        <ion-text class="listItemTitle">App Icon:</ion-text>
        @if (susApp.packageInfo.appIcon) {
          <ion-img
            class="icon iconBig"
            [src]="'data:image/png;base64,' + susApp.packageInfo.appIcon"
          />
        } @else {
          <ion-text class="listItem">Not specified</ion-text>
        }
        <br />

        <ion-text class="listItemTitle">Installer Store:</ion-text><br />
        <ion-text class="listItem">{{
          susApp.packageInfo.installerStore ?? 'Not specified'
        }}</ion-text
        ><br />

        <ion-text class="listItemTitle">Detected permissions:</ion-text><br />
        @if (susApp.permissions && susApp.permissions.length > 0) {
          @for (permission of susApp.permissions; track permission) {
            <ion-text class="listItem">{{ permission }}</ion-text
            ><br />
          }
        } @else {
          <ion-text class="listItem">Not specified</ion-text><br />
        }

        <ion-text class="listItemTitle">Detection reason:</ion-text><br />
        <ion-text class="listItem">{{ susApp.reason }}</ion-text
        ><br />

        <ion-row class="buttonGroup">
          <ion-button
            class="controlButton"
            shape="round"
            (click)="whitelistApp(susApp.packageInfo.packageName)"
          >
            Add to whitelist
          </ion-button>
          <ion-button
            class="controlButton"
            shape="round"
            (click)="appUninstall()"
          >
            Uninstall
          </ion-button>
        </ion-row>
      </div>
    }
  </ion-card-content>
</ion-card>
